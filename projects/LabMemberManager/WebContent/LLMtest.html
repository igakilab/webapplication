<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>LabMemberManagerテストページ</title>

	<script type="text/javascript" src="dwr/engine.js"></script>
    <script type="text/javascript" src="dwr/util.js"></script>
    <script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="js/jquery.serialize.js"></script>
    <script type="text/javascript" src="dwr/interface/LmmManager.js"></script>
    <script type="text/javascript" src="js/LmmInterface.js"></script>
    <script>
    	//アクションを登録する
    	function action_login(){
    		var uname = $("#name_input").val();
    		LmmLogin(uname, function(rep){
    			$("#action_reply").text(rep);
    		});
    	}

    	function action_logout(){
    		var uname = $("#name_input").val();
    		LmmLogout(uname, function(rep){
    			$("#action_reply").text(rep);
    		});
    	}

    	//レコードを確認する
    	function updateRecordTable(){
    		$("#MemList").empty();
    		$("#RecordList").empty();
    		$("#MemberRecordList").empty();

    		LmmAddMemberListToTable("MemList");

    		LmmGetActionRecordList(function(data){
    			addRecordTable($("#RecordList"), data);
    		});

    		addMemberRecordTable($("MemberRecordList"));
    	}

    	function addRecordTable(element, recobj){
    		var tmp = $("<table></table>");
    		tmp.attr("border", "1");
    		LmmAddRecordObjectToTable(tmp, recobj);
    		element.append(tmp);
    	}

    	function addMemberRecordTable(element){
    		LmmGetMemberList(function(member_list){
    			var rectmp;
    			for(var i=0; i<member_list.length; i++){
    				LmmGetActionRecordListByName(member_list[i].name, function(rec){
    					addRecordTable(element, rec);
    				});
    			}
    		});
    	}
    </script>
</head>

<body>
	<h3>LabMemberManagerテストページ</h3>
	<i>Version: record-system</i>

	<hr>

	<h4>アクションを登録する</h4>
	名前: <input id="name_input" type="text"></input><br>
	<button type="button" onclick="action_login()">LOGIN</button>
	<button type="button" onclick="action_logout()">LOGOUT</button>
	<p id="action_reply"></p>

	<hr>

	<h4>レコードを確認する</h4>
	<button type="button" onclick="updateRecordTable()">更新</button>
	<table id="MemList" border="1"></table>
	<div id="RecordList"></div>
	<div id="MemberRecordList"></div>
</html>
